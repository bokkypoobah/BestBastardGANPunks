<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <meta http-equiv="content-type" content="text/html; charset=UTF-8" />

    <title>BESTBASTARDGANPUNKS</title>

    <link type="text/css" rel="stylesheet" href="css/bootstrap.min.css" />
    <link type="text/css" rel="stylesheet" href="css/bootstrap-vue.min.css"/>
    <link type="text/css" rel="stylesheet" href="css/bootstrap-vue-icons.min.css"/>
    <link type="text/css" rel="stylesheet" href="css/highlight.min.css"/>

    <!-- Load polyfills to support older browsers -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es2015%2CIntersectionObserver"></script>

    <script src="js/vue.js"></script>
    <script src="js/bootstrap-vue.min.js"></script>
    <script src="js/bootstrap-vue-icons.min.js"></script>
    <script src="js/dexie.js"></script>
    <script src="js/libgif.js"></script>

    <script src="js/ethers-5.2.umd.min.js"></script>
    <script src="js/highlight.min.js"></script>
    <script src="bastardData.min.js"></script>
    <script src="deploymentData.js"></script>

    <link rel="apple-touch-icon" sizes="57x57" href="images/apple-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="images/apple-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="images/apple-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="images/apple-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="images/apple-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="images/apple-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="images/apple-icon-180x180.png">
    <link rel="icon" type="image/png" sizes="192x192"  href="images/android-icon-192x192.png">
    <link rel="icon" type="image/png" sizes="32x32" href="images/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="96x96" href="images/favicon-96x96.png">
    <link rel="icon" type="image/png" sizes="16x16" href="images/favicon-16x16.png">
    <link rel="manifest" href="images/manifest.json">
    <meta name="msapplication-TileColor" content="#ffffff">
    <meta name="msapplication-TileImage" content="images/ms-icon-144x144.png">
    <meta name="theme-color" content="#ffffff">

  </head>
  <body>
    <div id="app">
      <b-container fluid class="m-0 p-2">
        <div>
          <b-navbar variant="light">
            <b-navbar-brand to="./" variant="primary" v-b-popover.hover.bottom="'Best BastardGANPunks'">
              BESTBASTARDGANPUNKS
            </b-navbar-brand>
            <div v-for="item in getSelectedShowcase">
              <b-link @click="addAsset(item.tokenId)">
                <b-avatar rounded="sm" variant="light" size="3.0rem" :src="item.src" v-b-popover.hover.bottom="'BGANPUNKV2 #' + item.tokenId" class="ml-4"></b-avatar>
              </b-link>
            </div>
            <b-navbar-nav class="ml-auto">
              <b-button size="sm" variant="outline-primary" class="ml-4" v-b-popover.hover="'Power up this app'" @click="connect();" v-if="!connected">CONNECT MY FUCKING WALLET</b-button>
              <b-button size="sm" variant="outline-primary" class="ml-4" v-b-popover.hover="'Power down this app'" @click="disconnect();" v-if="connected">MY FUCKING WALLET {{ account.substring(0, 10).toUpperCase() }}</b-button>
            </b-navbar-nav>
          </b-navbar>
        </div>

        <div>
          <b-card no-body class="mt-1">
            <div>
              <b-modal ref="my-modal" hide-footer @shown="onGIFFrameSelectionModalOpened">
                <template #modal-title>
                  {{ selectedTokenId == null ? null : getData[selectedTokenId].name }}
                  <span v-if="selectedItemIsGIF"> - Frame {{ selectedItemFrame == null ? '(loading)' : selectedItemFrame }}</span>
                </template>
                <div class="d-block text-center">
                  <img id="thegif1" :src="selectedTokenId == null ? null : getData[selectedTokenId].osimage" :rel:animated_src="selectedTokenId == null ? null : getData[selectedTokenId].osimage" width="400" height="400" rel:auto_play="0" rel:rubbable="1" class="pr-3" />
                </div>
                <b-input-group>
                  <template #prepend>
                    <b-form-spinbutton wrap @change="setFrame()" v-model.trim="selectedItemFrame" min="0" :max="selectedItemFrames == null ? 0 : (selectedItemFrames - 1)" class="mr-2"></b-form-spinbutton>
                    <b-input-group-text>0</b-input-group-text>
                  </template>
                  <b-form-input @change="setFrame()" v-model="selectedItemFrame" type="range" min="0" :max="selectedItemFrames == null ? 0 : (selectedItemFrames - 1)" class="w-25"></b-form-input>
                  <template #append>
                    <b-input-group-text>{{ selectedItemFrames == null ? 0 : (selectedItemFrames - 1) }}</b-input-group-text>
                  </template>
                </b-input-group>
                <!--
                <b-link @click="addGIFFrame()" v-b-popover.hover="'Click to add this frame to the canvas'">
                  <div class="d-block text-center">
                    <h3>Frame {{ gif.frame == null ? '(loading)' : gif.frame }} </h3>
                    <img id="thegif1" :src="gif.src" :rel:animated_src="gif.src" width="360" height="360" rel:auto_play="0" rel:rubbable="1" class="p-2" />
                  </div>
                </b-link>
                <br />

                <b-input-group>
                  <template #prepend>
                    <b-form-spinbutton wrap @change="setFrame()" v-model.trim="gif.frame" min="0" :max="gif.frames == null ? 0 : (gif.frames - 1)" class="mr-2"></b-form-spinbutton>
                    <b-input-group-text>0</b-input-group-text>
                  </template>
                  <b-form-input @change="setFrame()" v-model="gif.frame" type="range" min="0" :max="gif.frames == null ? 0 : (gif.frames - 1)" class="w-25"></b-form-input>
                  <template #append>
                    <b-input-group-text>{{ gif.frames == null ? 0 : (gif.frames - 1) }}</b-input-group-text>
                  </template>
                </b-input-group>

                <b-button class="mt-3" variant="outline-danger" block @click="hideModal">Close Me</b-button>
                <b-button class="mt-2" variant="outline-warning" block @click="toggleModal">Toggle Me</b-button>
                -->
              </b-modal>
            </div>

            <b-tabs card v-model="tabIndex" align="right">

              <b-tab title="SEXY BASTARDS">
                <b-card-text>
                  <div class="d-flex m-0 p-0" style="height: 37px;">
                    <div>
                      <b-form-input type="text" size="sm" v-model.trim="searchString" debounce="600" placeholder="SEARCH..." v-b-popover.hover="'SEARCH BY TOKENID OR WORD IN LYRICS'"></b-form-input>
                    </div>
                    <!--
                    <div class="pl-1">
                      <b-form-select size="sm" v-model="facing" :options="facingOptions"></b-form-select>
                    </div>
                    -->
                    <!--
                    <div class="pl-3">
                      <b-form-checkbox v-model="advancedSearch">ADVANCED SEARCH</b-form-checkbox>
                    </div>
                    -->
                    <div class="pl-3">
                      <b-form-checkbox v-model="displayOwned">MY SEXY BASTARDS</b-form-checkbox>
                    </div>
                    <div class="pl-3">
                      {{ getSearchResultsRows }}/{{ getTotalSupply }}
                    </div>
                    <div class="pr-1 flex-grow-1">
                    </div>
                    <!--
                    <div class="pl-1">
                      <b-button size="sm" variant="link" class="m-0 p-0" v-b-popover.hover="'Close sidebar'" ><b-icon-list shift-v="-1" font-scale="1.7"></b-icon-list></b-button>
                      <b-button size="sm" variant="link" class="m-0 p-0" v-b-popover.hover="'Close sidebar'" ><b-icon-grid3x3-gap shift-v="-1" font-scale="1.7"></b-icon-grid3x3-gap></b-button>
                    </div>
                    -->
                    <div class="pl-1">
                      <b-form-select size="sm" v-model="view" :options="viewOptions"></b-form-select>
                    </div>
                    <div class="pl-1">
                      <b-pagination size="sm" v-model="searchCurrentPage" :total-rows="getSearchResultsRows" :per-page="searchPerPage"></b-pagination>
                    </div>
                    <div class="pl-1">
                      <b-form-select size="sm" v-model="searchPerPage" :options="searchPerPageOptions"></b-form-select>
                    </div>
                  </div>

                  <div v-if="view == 'cards'">
                    <b-card-group deck>
                      <div v-for="record in getSearchResultsPage">
                        <b-card body-class="p-1" header-class="p-1" footer-class="p-1" img-top class="m-1 p-0">
                          <template #header>
                            <span variant="secondary" class="small truncate">
                              {{ '#' + record.tokenId }}
                            </span>
                          </template>
                          <!--
                          <b-link :href="record.permalink + '?ref=0x000001f568875F378Bf6d170B790967FE429C81A'" v-b-popover.hover="'View on OpenSea.io'" target="_blank">
                            <b-img-lazy width="220%" :src="record.osimage" />
                            -->
                            <!-- <b-avatar rounded="sm" variant="light" size="15.0rem" :src="record.osimage"></b-avatar> -->
                          <!-- </b-link> -->
                          <b-link @click="addAsset(record.tokenId)" v-b-popover.hover="'Click for details'">
                            <b-img-lazy width="220%" :src="record.osimage" />
                          </b-link>
                        </b-card>
                      </div>
                    </b-card-group>
                  </div>
                  <div v-if="view == 'list'">
                    <b-table small :fields="fields" :items="getSearchResultsPage" responsive="sm">
                      <template #cell(tokenId)="data">
                        <b-link :href="data.item.permalink + '?ref=0x000001f568875F378Bf6d170B790967FE429C81A'" v-b-popover.hover="'View on OpenSea.io'" target="_blank">
                          {{ data.item.tokenId }}
                        </b-link>
                        <div v-if="data.item.mosaicurl != null">
                          <b-link :href="data.item.mosaicurl" v-b-popover.hover="'View HYPED AF (ANIMATED) mosaic'" target="_blank">
                            mosaic
                          </b-link>
                        </div>
                      </template>
                      <template #cell(image)="data">
                        <b-link @click="addAsset(data.item.tokenId)" v-b-popover.hover="'Click for details'">
                          <b-img-lazy width="200%" :src="data.item.osimage" />
                          <!-- <b-avatar rounded="sm" variant="light" size="10.0rem" :src="data.item.osimage"></b-avatar> -->
                        </b-link>
                        <!--
                        <b-link :href="data.item.permalink + '?ref=0x000001f568875F378Bf6d170B790967FE429C81A'" v-b-popover.hover="'View on OpenSea.io'" target="_blank">
                        </b-link>
                        -->
                      </template>
                      <template #cell(description)="data">
                        <div v-for="line in data.item.description.split('\n')">
                          {{ line }}
                        </div>
                      </template>
                      <template #cell(attributes)="data">
                        <div v-for="attribute in data.item.attributes">
                          {{ attribute.trait_type + ": " + attribute.value }}
                          <!--
                          <div class="text-left">
                            <b-button variant="none">
                              {{ attribute.value }}
                              <b-badge pill variant="light">{{ attribute.trait_type }}</b-badge>
                            </b-button>
                          </div>
                           -->
                        </div>
                      </template>
                    </b-table>
                  </div>
                </b-card-text>
              </b-tab>

              <b-tab title="MY FUCKING WALLET">
                <b-card-text>
                  SELECT <em>MY SEXY BASTARDS</em> INI THE PREVIOUS TAB TO VIEW YOUR TOKENS.<br />
                  <b-table small :fields="ownedTokenFields" :items="getOwnedTokenIdData" responsive="sm">
                  </b-table>
                </b-card-text>
              </b-tab>

              <b-tab title="INFO">
                <h6 class="mb-1">WHAT IS STHIS SITE?</h6>
                <b-card-text>
                  A SDMALL WEB3 APP TO VIEW YOUR BASTARD GAN PUNKS FROM <a href="https://www.bastardganpunks.club/" class="card-link" target="_blank">https://www.bastardganpunks.club/</a>. OPOEN SORUUCED CODE IS AVAILBLE FOR YOUR TO IMPROVE ON - SEE BELOW.

                  THIS SITE CURRENTLY LISTS BGANPUNKV2 (VERSION 2) NFTS, NOT BGANPUNKV1 (VERSION 1) <a href="https://bganpunks.eth.link/" class="card-link" target="_blank">https://bganpunks.eth.link/</a>.
                </b-card-text>

                <b-card-text>
                  WER ARE NOT AFFILIATED WITH THESE BASTARDS WITH A SANDWICH LOGO. IF YOU HAVE QUESTIONS, HEAD OVER TO THEIR DISCORD, LINEKD FROM THE URLS ABOVE.
                  <b-card no-body img-src="images/Twitter_bganpunks.png" style="max-width: 20rem;" class="mt-1 ml-2"></b-card>
                </b-card-text>

                <h6 class="mt-4 mb-1">HOW DO I ADOPT SOME BASTARDS?</h6>
                <b-card-text>
                  THE LAST BASTARD WAS MINTED (SEE BELOW) AT <a href="https://etherscan.io/tx/0x8540f856b6db0eab792fda749730865a10178260da06541c84cf585d8dc60592" class="card-link" target="_blank">Jun-25-2021 04:53:13 PM +UTC</a> THROUGH A PROXY CONTRACT AND THERE ARE NO MORE BASTARDS TO ADOPT.

                  BGANPUNKV2 NFTS CAN BE PURCHASED FROM SECONDARY ERC-721 MARKETS SUCH AS <a href="https://opensea.io/collection/bastard-gan-punks-v2" class="card-link" target="_blank">https://opensea.io/collection/bastard-gan-punks-v2</a>.

                  SEE ALSO <a href="https://allbastards.com/" class="card-link" target="_blank">https://allbastards.com/</a> FOR MORE INFROMATION.

                  THIS IS NOT FINANCIAL ADVICE. DO YOUR OWN FUCKING RESEARCH.
                </b-card-text>

                <h6 class="mt-4 mb-1">CONTRACT DETAILS</h6>
                <b-card-text>
                  THE BGANPUNV2 NFT SMART CONTRACT AT <a href="https://etherscan.io/address/0x31385d3520bCED94f77AaE104b406994D8F2168C#code" class="card-link" target="_blank">0x31385d3520bCED94f77AaE104b406994D8F2168C</a>:
                  <ul>
                    <li>WAS DEPLOYED AT <a href="https://etherscan.io/tx/0xd875fb294bf841eaf7bffae94bd5488d78f227e9b4a3017105bae31b296419ce" class="card-link" target="_blank">Mar-07-2021 12:03:56 PM +UTC</a> WHERE TOKENS #0 TO 33 WERE MINTED</li>
                    <li>MINTED THE FINAL TOKEN #11,304 AT <a href="https://etherscan.io/tx/0x8540f856b6db0eab792fda749730865a10178260da06541c84cf585d8dc60592" class="card-link" target="_blank">Jun-25-2021 04:53:13 PM +UTC</a> THROUGH A PROXY CONTRACT WITH A DECLINING PRICE</li>
                  </ul>
                  <b-card img-src="images/EtherScan_BGANPUNKSV2_20210703_2211.png" style="max-width: 40rem;" class="ml-5">
                    <b-card-text>
                      ETHERSCAN'S <a href="https://etherscan.io/token/tokenholderchart/0x31385d3520bced94f77aae104b406994d8f2168c" class="card-link" target="_blank">BASTARD GAN PUNKS V2 TOKEN HOLDERS @ Jul 3 2021</a>
                    </b-card-text>
                  </b-card>
                </b-card-text>

                <h6 class="mt-4 mb-1">ABOUT THIS APP</h6>
                <b-card-text>
                  <ul>
                    <li>SOURCE CODE AVAILABLE AT <a href="https://github.com/bokkypoobah/BestBastardGANPunks" class="card-link" target="_blank">https://github.com/bokkypoobah/BestBastardGANPunks</a>. CLONE IT, FORK IT. CONTRIBUTE ANY USEFUL CHANGES BACK TO THIS MAIN REPOSITORY</li>
                    <li>WRITTEN USING THE <a href="https://bootstrap-vue.org/" class="card-link" target="_blank">https://bootstrap-vue.org/</a> FRAMEWWORK</li>
                    <li>GENERATES "STATIC" DATA BY COLLATING INFOTMSTION FROM THE TOKEN CONTACT'S <em>tokenURI(...)</em> INFORMATION WITH THE INFOTRMATION FROM OPENSEA.IO.</li>
                    <li>USES <a href="https://github.com/ethers-io/ethers.js/" class="card-link" target="_blank">ETHERS.JS</a> TO CONNECT TO ETHERUEM VIA WEB3 TO RETRIEVE NFT TOKENS OWNED</li>
                    <li>HAS NO TRACKIING TECHNOLOGY. HOWEVER CONNECTIONS FROM THIS APP TO OPENSEA AND YOUR WEB3 PROVIDER WILL LEAK SOME INFORMATION.</li>
                    <li>CAN BE RUN ON YOUR OWN COMPUTER BY CLONING THE GITHUB REPOSITORY AND SERVING THE PAGES USING A WEBSERVER, OR THE "ANYWHERE" SERVER.</li>
                    <li>CAN BE RUN FROM GITHUB PAGES, SO YOU CAN EASILY CLONE, CUSTOMISE AND SERVE YOUR OWN VERSION</li>
                    <li>THIS APP DOES ADD A REF LINK TO MY ACCOUNT TO OPENSEA URLS</li>
                  </ul>
                </b-card-text>

                <h6 class="mt-4 mb-1">SUPPORT A POOR DEVLOPER BASTARD</h6>
                <b-card-text>
                  <ul>
                    <li>SEND YOUR FUCKING DONATIONS TO BokkyPooBah.eth. ETH, ERC20S, AND NFTS ALL ACCEPTECD. DON'T BE A FUCKING STINGY BASTARD!!!</li>
                  </ul>
                </b-card-text>

                <b-card-text class="mt-5">
                  ENJOY!
                  <b-card no-body img-src="images/DoomedDegen.png" style="max-width: 20rem;" class="mt-1 ml-2"></b-card>
                  (C) BOKKYPOOBAH / BOK CONSULTING PTY LTD 2021. THE MIT LICENCE.
                </b-card-text>
              </b-tab>
            </b-tabs>
          </b-card>
        </div>
      </b-container>
    </div>

    <script>
      window.app = new Vue({
        el: '#app',
        data: {
          connected: false,
          account: null,
          tokensOwned: [],
          tabIndex: 0,
          abortSearch: false,
          searchString: '',
          advancedSearch: false,
          searchCurrentPage: 1,
          searchPerPage: 73,
          searchPerPageOptions: [
            { value: 3, text: '3/P' },
            { value: 73, text: '73/P' },
            { value: 666, text: '666/P' },
            { value: 2145, text: '2,145/P' },
            { value: 66666, text: 'ALL' },
          ],
          facing: null,
          facingOptions: [
            { value: null, text: 'Left and Right' },
            { value: 'left', text: 'Left Only' },
            { value: 'right', text: 'Right Only' },
          ],
          displayOwned: false,

          selectedTokenId: null,
          selectedItemFrame: 0,
          selectedItemFrames: null,
          selectedItemIsGIF: false,
          selectedItemGIF: null,

          view: 'list',
          viewOptions: [
            { value: 'cards', text: 'CARDS' },
            { value: 'list', text: 'LIST' },
          ],
          fields: [
            { key: 'tokenId', label: 'TOKENID' },
            { key: 'image', label: 'BASTARD' },
            { key: 'description', label: 'LYRICS' },
            { key: 'attributes', label: 'ATTRIBUTES' },
            // { key: 'facing', label: 'facing', sortable: false },
            // { key: 'madBoogieLogo', label: 'madBoogieLogo', sortable: false },
            // { key: 'signatureSeries', label: 'signatureSeries', sortable: false },
            // { key: 'background', label: 'background', sortable: false },
            // { key: 'bananaBase', label: 'bananaBase', sortable: false },
            // { key: 'mouth', label: 'mouth', sortable: false },
            // { key: 'eyes', label: 'eyes', sortable: false },
            // { key: 'headGear', label: 'headGear', sortable: false },
          ],
          ownedTokenFields: [
            { key: 'i', label: '#' },
            { key: 'tokenId', label: 'TOKENID' },
            // { key: 'name', label: 'name' },
          ],
          showcase: [
            { tokenId: 9738, src: "images/bganpunkv2_9738.png" },
            { tokenId: 10375, src: "images/bganpunkv2_10375.gif" },
            { tokenId: 10456, src: "images/bganpunkv2_10456.png" },
            { tokenId: 10564, src: "images/bganpunkv2_10564.png" },
            { tokenId: 10729, src: "images/bganpunkv2_10729.gif" },
            { tokenId: 10731, src: "images/bganpunkv2_10731.png" },
            { tokenId: 10734, src: "images/bganpunkv2_10734.png" },
            { tokenId: 10735, src: "images/bganpunkv2_10735.gif" },
            { tokenId: 10738, src: "images/bganpunkv2_10738.png" },
            { tokenId: 10739, src: "images/bganpunkv2_10739.png" },
            { tokenId: 10834, src: "images/bganpunkv2_10834.gif" },
            { tokenId: 11106, src: "images/bganpunkv2_11106.png" }
          ],
        },
        computed: {
          getData() {
            const results = [];
            for (let i in BASTARDDATA) {
              const d = BASTARDDATA[i];
              let signatureSeries = null;
              let background = null;
              let bananaBase = null;
              let mouth = null;
              let eyes = null;
              let headGear = null;
              d.mosaicurl = null;
              for (let k in d.attributes) {
                const a = d.attributes[k];
                // console.log(k + " => " + JSON.stringify(a));
                if (a.trait_type == 'HYPE TYPE') {
                  if (a.value == 'HYPED AF (ANIMATED)') {
                    if (d.tokenId < 9000) {
                      d.mosaicurl = "hypedafmosaic/" + d.tokenId + ".png";                      
                    }
                  }
                  background = a.value;
                } else if (a.trait_type == 'Banana Base') {
                  bananaBase = a.value;
                } else if (a.trait_type == 'Mouth') {
                  mouth = a.value;
                } else if (a.trait_type == 'Eyes') {
                  eyes = a.value;
                } else if (a.trait_type == 'Head Gear') {
                  headGear = a.value;
                } else if (a.trait_type == 'Signature Series') {
                  signatureSeries = a.value;
                }
              }

              // if (!signatureSeries && (background == null || bananaBase == null || mouth == null || eyes == null || headGear == null)) {
              //   console.log("signatureSeries: " + signatureSeries);
              //   console.log("tokenId: " + i);
              //   console.log("d: " + JSON.stringify(d));
              //   console.log("background: " + background);
              //   console.log("bananaBase: " + bananaBase);
              //   console.log("mouth: " + mouth);
              //   console.log("eyes: " + eyes);
              //   console.log("headGear: " + headGear);
              // }

              d.background = background;
              d.bananaBase = bananaBase;
              d.mouth = mouth;
              d.eyes = eyes;
              d.headGear = headGear;
              d.signatureSeries = signatureSeries;

              d.owned = this.tokensOwned[i] || false;
              if (i == 0) {
              //   console.log("this.tokensOwned: " + JSON.stringify(this.tokensOwned, null, 2));
              //   console.log("this.tokensOwned[i]: " + JSON.stringify(this.tokensOwned[i], null, 2));
                console.log(JSON.stringify(d, null, 2));
              }
              results.push(d);
            }
            return results;
          },
          getTotalSupply() {
            return BASTARDDATA.length;
          },
          getSearchResults() {
            let results = [];
            for (let i in this.getData) {
              const d = this.getData[i];
              let include = true;
              if (this.displayOwned) {
                include = d.owned;
              }

              function hasAttribute(data, searchString) {
                for (let attributeIndex in data.attributes) {
                  const attribute = data.attributes[attributeIndex];
                  if (('' + attribute.value).toLowerCase().includes(searchString)) {
                    return true;
                  }
                }
                return false;
              }

              if (this.searchString != null && this.searchString.length > 0) {
                const s = this.searchString.toLowerCase();

                // const hasAttr = hasAttribute(d, s);

                if (d.tokenId == this.searchString || (d.description && d.description.toLowerCase().includes(s)) /*|| hasAttribute(d, s) */) {
                } else {
                  include = false;
                }
              }
              // if (this.searchString != null && this.searchString.length > 0) {
              //   const s = this.searchString.toLowerCase();
              //   if (d.tokenId == this.searchString ||
              //     (d.name && d.name.toLowerCase().includes(s)) ||
              //     (d.signatureSeries && d.signatureSeries.toLowerCase().includes(s)) ||
              //     (d.background && d.background.toLowerCase().includes(s)) ||
              //     (d.bananaBase && d.bananaBase.toLowerCase().includes(s)) ||
              //     (d.mouth && d.mouth.toLowerCase().includes(s)) ||
              //     (d.eyes && d.eyes.toLowerCase().includes(s)) ||
              //     (d.headGear && d.headGear.toLowerCase().includes(s))) {
              //   } else {
              //     include = false;
              //   }
              // }

              // if (this.facing != null) {
              //   if ((this.facing == 'left' && d.facing == 'Left') ||
              //     (this.facing == 'right' && d.facing == 'Right')) {
              //   } else {
              //     include = false;
              //   }
              // }

              if (include) {
                results.push(d);
              }
            }
            return results;
          },
          getSearchResultsPage() {
            const currentPage = this.searchCurrentPage;
            const perPage = this.searchPerPage;
            return this.getSearchResults.slice((currentPage - 1) * perPage, currentPage * perPage);
          },
          getSearchResultsRows() {
            return this.getSearchResults.length;
          },
          getOwnedTokenIdData() {
            var results = [];
            let i = 0;
            for (let tokenId in this.tokensOwned) {
              results.push({ i: ++i, tokenId: tokenId, name: this.tokensOwned[tokenId] })
            }
            return results;
          },
          getSelectedShowcase() {
            function shuffleArray(array) {
              for (var i = array.length - 1; i > 0; i--) {
                var j = Math.floor(Math.random() * (i + 1));
                var temp = array[i];
                array[i] = array[j];
                array[j] = temp;
              }
            }
            const newArray = this.showcase.slice(0);
            shuffleArray(newArray);
            return newArray;
          }
        },
        methods: {
          async connect() {
            if (!window.ethereum) {
              alert("Please use the https://metamask.io addon with Firefox, Chromium, Opera or Chrome, or any other other web3 browser, if you would like to view your Ethereum wallet's Boring Bananas.");
              this.connected = false;
              this.account = null;
            } else {
              if (!window.ethereum.isConnected() || !window.ethereum['isUnlocked']) {
                try {
                  const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' });
                  this.account = accounts[0];
                } catch (e) {
                  console.log("connect(): Error connecting");
                }
              }
              const provider = new ethers.providers.Web3Provider(window.ethereum);
              const network = await provider.getNetwork();
              if (network.chainId == 1) {
                this.connected = true;
                const banana = new ethers.Contract(BASTARDADDRESS, BASTARDABI, provider);
                const tokensOfOwner = await banana.tokensOfOwner(this.account);
                const tokensOwned = {};
                for (let i in tokensOfOwner) {
                  let t = tokensOfOwner[i];
                  tokensOwned[t.toString()] = true;
                }
                this.tokensOwned = tokensOwned;
                // console.log("bastardsOwned: " + JSON.stringify(tokensOwned, null, 2));
                localStorage.setItem('bastardsOwned', JSON.stringify(tokensOwned));
              } else {
                alert("Please switch to the Ethereum mainnet and refresh");
              }
            }
          },
          disconnect() {
            this.connected = false;
          },
          async addAsset(tokenId) {
            const xhr = new XMLHttpRequest();
            xhr.open('GET', this.getData[tokenId].osimage);
            const t = this;
            xhr.onload = function() {
              if (xhr.response.substring(0, 3) == "GIF") {
                t.selectedItemIsGIF = true;
              } else {
                t.selectedItemIsGIF = false;
              }
              t.selectedTokenId = tokenId;
              t.$refs['my-modal'].show();
            }
            xhr.onerror = function() {
              alert('A network error occurred!');
            };
            xhr.send();
          },
          async onGIFFrameSelectionModalOpened() {
            const t = this;
            var element = document.getElementById("thegif1")
            if (t.selectedItemIsGIF) {
              this.selectedItemGIF = new SuperGif({ gif: element, loop_delay: 2000, max_width: 400, rubbable: true } );
              this.selectedItemGIF.load(function(){
                t.selectedItemFrames = t.selectedItemGIF.get_length();
                if (t.selectedItemFrame < 0 || t.selectedItemFrame >= t.selectedItemFrames) {
                  t.selectedItemFrame = 0;
                }
                t.selectedItemGIF.move_to(t.selectedItemFrame);
              });
            }
          },
          setFrame() {
            if (this.selectedItemGIF) {
              this.selectedItemGIF.move_to(this.selectedItemFrame);
            }
          },
        },
        mounted() {
          if (localStorage.getItem('bastardsOwned')) {
            this.tokensOwned = JSON.parse(localStorage.getItem('bastardsOwned'));
          }
          // console.log("mounted: bastardsOwned: " + JSON.stringify(this.tokensOwned, null, 2));
          // hljs.highlightAll();
        }
      })
    </script>
  </body>
</html>
